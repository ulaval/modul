<div class="m-typeahead"
     :class="{ 'm--is-results-window-open': isResultsPopupOpen,
   'm--is-disabled': isDisabled,
   'm--is-waiting': isWaiting,
   'm--has-validation-message': hasValidationMessage }"
     :style="{ width: inputWidth, maxWidth: inputMaxWidth }">
    <m-base-select :control-id="id"
                   :active="active"
                   :items="filteredResults"
                   :open.sync="isResultsPopupOpen"
                   :input-max-width="inputMaxWidth"
                   @select-item="onSelect"
                   ref="mBaseSelect">
        <template v-slot:default="scope">
            <m-textfield v-model="textfieldValue"
                         :label="label"
                         :placeholder="placeholder"
                         :disabled="isDisabled"
                         :waiting="isWaiting"
                         :focus="focus"
                         :error="hasError"
                         :valid="isValid"
                         :required-marker="requiredMarker"
                         :tag-style="tagStyle"
                         :cursor-pointer="true"
                         :max-length="maxLength"
                         :length-overflow="lengthOverflow"
                         :character-count="characterCount"
                         :character-count-threshold="characterCountThreshold"
                         :max-width="inputMaxWidth"
                         :aria-controls="ariaControls"
                         aria-haspopup="true"
                         :aria-expanded="scope.open"
                         @input="onInput"
                         @keydown="emitKeydown"
                         @keyup="onKeyup"
                         @keydown.up.prevent="scope.keyUp"
                         @keydown.down.prevent="scope.keyDown"
                         @keydown.enter.prevent="scope.keyEnter"
                         @keydown.return.prevent="scope.keyEnter"
                         @keydown.esc="scope.keyEsc"
                         @keydown.tab="scope.keyTab"
                         @focus="onFocus"
                         @blur="onBlur"
                         ref="mTextfield">
            </m-textfield>
            <m-validation-message class="m-typeahead__validation-message"
                                  :disabled="isDisabled"
                                  :waiting="isWaiting"
                                  :error="hasError"
                                  :valid="isValid"
                                  :error-message="errorMessage"
                                  :valid-message="validMessage"
                                  :helper-message="helperMessage"></m-validation-message>
        </template>
        <template v-slot:items="{item , index }">

            <slot name="items"
                  :item="item"
                  :index="index"><span v-html="getTextHighlight(item)"></span></slot>
        </template>
    </m-base-select>
</div>
